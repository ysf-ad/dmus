AvisOptionsConfig.featured_product = [
  ".featured-product",
  ".ecom-product-form.ecom-product-form--single",
  ".t4s-featured-product",
  ".home-featured-product",
  ".sf-featured-product",
  ".product-section[data-section-type='product-template']",
  ".shopify-section.mount-featured-product",
  ".shopify-section.index-section--featured-product",
  "div[id*='__featured_product'].shopify-section.index-section .product-section",
  "div[id*='featured_product'].shopify-section .section-featured-product",
  "div[id*='featured_product'].shopify-section .ctnr",
  "div[data-category='Featured Product']",
  ".shopify-section.shopify-section--featured-product",
  ".featured-product-section",
  "div[id*='featured_product'].shopify-section"
];
AvisOptionsConfig.quick_view = {
  themeQuickview: ["Refresh"],
  themeSetintervalCollection: ["Refresh"],
  quickViewButtonSubmit: [
    'a.t4s-pr-item-btn.t4s-pr-quickview.t4s-tooltip-actived:not(.apo-quickview)',
    'button.quick-add__submit:not(.apo-quickview)',
    'a.t4s-pr-item-btn.t4s-pr-addtocart.t4s-tooltip-actived:not(.apo-quickview)',
    '.quick-add button.quick-add__submit:not(.apo-quickview)',
    '.ecom-collection__product--quickview-wrapper .ecom-product-quickview:not(.apo-quickview)',
    '.product-card__btn[data-quick-view-id="Quick-view"]:not(.apo-quickview)',
    '.grid__item a.quick-view:not(.apo-quickview)',
    'button.product-card__quick-add-button:not(.apo-quickview)',
    '.button-cart-bottom:not(.apo-quickview)',
    '.btn.btn--tertiary.show-product-quickview:not(.apo-quickview)',
    '.quick-view a.engoj_btn_quickview:not(.apo-quickview)',
    '.card-quickview.card-quickviewIcon .quickview-icon:not(.apo-quickview)',
    'button.btn-quick-view:not(.apo-quickview)',
    '.product__quickbuy button:not(.apo-quickview)',
    '.product-image .quick-view:not(.apo-quickview)',
    '.quick_shop.js-quick-shop-link:not(.apo-quickview)',
    'a[data-fancybox*="quick-view"]:not(.apo-quickview)',
    '.btn.open-quick-view--btn:not(.apo-quickview)',
    'quick-add-button:not(.apo-quickview)',
    'button-quickview.button-quickview:not(.apo-quickview)',
    '.quickView.mobile-hide:not(.apo-quickview)',
    '.list-unstyled.yv-product-options:not(.apo-quickview)',
    'button.primary-button.quick-view-button:not(.apo-quickview)',
    '.product-item__quick-form .button--outline:not(.apo-quickview)'
  ],
  quickViewModal: [
    '.t4s-modal--is-active',
    '.quick-add-modal[open]',
    '.ecom-quickview__wrapper.ecom-open',
    '.quick-view.is-opened',
    'div.fancybox-opened .ncfe-pre-primary-bundle',
    'quick-buy-modal[open]',
    '.mfp-wrap.mfp-close-btn-in',
    '.quick-product--wrap.active',
    '.quickview-product.tshopify-popup.active',
    '#halo-quick-view-popup',
    'sht-dialog-quickshop',
    '#quickViewModal.show',
    '.remodal-wrapper.remodal-is-opened',
    '.fancybox-container.quickview-popup.fancybox-is-open',
    '#modal-quick-view',
    'quick-add-modal#quick-add-modal',
    'quickbuy-canvas.active',
    '.yv_side_drawer_wrapper.yv_quickView_product',
    '#quickViewDrawer.is-open',
    'quick-buy-drawer[open]'
  ]
};
AvisOptionsConfig.productVariantPriceWrapperSelector = [
  ".thb-product-detail .product-price-container" // Habitat version 1.6.2
  , ".product__info-container div[id*='price-template']" // theme shopify
  , ".product__info-container div[id*='price-quickadd-template']" // theme shopify quickview
  , ".al_center.price-review" // theme Kalles 2.7.1
  , ".product-form__info-item" // theme Warehouse v2.8.2, v1.16.4
  , ".tt-price" // theme Wokiee version 2.2.2 shopify 2.0
  , ".t4s-product__price-review" // theme Kalles version 4.0.4
  , ".ecom-product-single.ecom-product-single__price--prices" // key ECom
  , ".product-info__price .rating-with-text" // theme Impact version 4.3.0
  //, ".price.product__price .price__current" // theme Empire
  , ".f-price__regular" // theme Minimog - OS 2.0 version 3.4.0
  //,".product-form.theme-init" // Symmetry version 5.6.0
  , ".f8pr .f8pr-price.price" // Xtra version 4.0.0 available
  , ".product-single__primary-blocks .price" // Venue version 10.0.5 available
  , ".price__pricing-group" // Testament version 12.2.0 available
  //, ".product-info .product-info__block-item[data-block-type='price']" // Prestige version 8.2.0
  , ".product-info__sticky .product-info__price" // Enterprise version 1.4.2
  , ".product-info__price .price" // Enterprise version 1.4.0
  //,"span[data-product-price].product__price" // Motion version 10.4.0
  , "div.price-container div.variant-visibility-area div.price-area" // Symmetry version 6.0.3
  , ".product-price-container .price" // Reformation version 1.6.2
  , ".price-area" // Athens version 2.0.0
  , ".product--page .product-price__cost" // Aurora version 3.0.2
  , ".main-product__block-price" //MINIMOG v5.0.2 - Pan store
  , "form.shopify-product-form .items-end.justify-between"
  //, ".product-block--title + .product-block--price .product-single__prices" //Streamline 4.4.1 80845308239
  //, ".product-single__prices" //Minimal 12.0.2
  , ".wrap-product-info .priceSingle"
  , ".product-block--price .modal_price" //Turbo 9.2.0
  , ".product-block.product-block--price .product-pricing:not([data-product-pricing])" //Superstore 5.1.0
  , ".content-item-container .price__container" //Area 1.3.3
  , ".productView-details .productView-price" //Ella 6.5.4
  , ".product__app-block + div .product__price .price__container" //Sahara 1.1.10
  //,".product__content div[id*='Product-Price-template']"
  //, "div[data-product-blocks] .product-block.product-block--price" //Impulse 7.4.1
  , ".yv-pricebox-outer div.yv-prizebox[data-price-wrapper]" //Yuva 12.1.0
  , ".product__title + div[id*='Product-Price-template--'] .price__regular" //Sahara 1.1.10 86728704276
  , ".product-actions .product-price" //Local 2.3.2 64170688683
  , ".Product__InfoWrapper .Product__Info .ProductMeta__PriceList" // Prestige version 4.1.0 61112254697
  , ".product-details-wrapper #ProductPrice" // Flow version 33.0.0 59927363743
  , ".content-page-detail .product-price" // Janier version 1.0.0 82220450067
  , ".main-content div[data-pf-type='ProductPrice2']" // PageFly 59252080811
  // , ".product__info-wrapper product-info .price__container" // Dawn 87373545759
  , ".product__block__price .product__price__wrap" // Pipeline 7.2.1 79302132006
  , ".product-single__meta div[data-product-blocks] .product-block.product-block--price"  // Motion 10.4.1 71974158653 and Streamline 4.4.1 80845308239
  , ".product-block.product-block--price .product-pricing[data-product-pricing]"  // Empire 9.1.1 52262240425 and 11.0.0 63207538849
  , ".product__info.product__block-price div[id*='productPrice-template']" // Shine 1.1.0 Page Fly
  , ".product__prices div[id*='productPrice-template'] .price.price--large" // Electro 1.4.0 Page Fly
  , ".product-single__form-price" // Expanse 1.0.5 59286225080
  , ".product-single__meta .price-main" // Velatheme 2.0.0 71189233952
  , ".product_details_info .price-block" // Spront 1.0.0 70102352088
  , ".price-container.text-money" // Debutify 3.0.4 57964363930
  , "#ProductSection .product-single .product-single__prices" // Minimal 11.7.11 37274026115
  , ".product-block--price .price-container[data-price-container] .price-container__price .price-container__price" // Retina 7.3.0 10944892
  , ".modal_price .price__container span .current_price" // 54942433488
  , ".product-info__block-item[data-block-type='price'] .price-list.price-list--product" // Prestige 10.0.0 68329144558
  , "#productPrice-product-template" // Supply 8.5.0 25331662957
  , "div[id*=price-template] .main-product-price.price" // Eurus 64108757169
  , ".product-detail__price.product-price[data-price-wrapper]" // Boost 27289256036
  , ".product__price.product__block.product__block--small" // Spark 57017368679
];

AvisOptionsConfig.productPriceSelector = [
  ".price__sale span.price-item.price-item--sale"
  , ".ProductMeta__Price.Price.Price--highlight"
  , ".product-block--price span[data-product-price]"
  , ".product-block-group--price .m-price-item.m-price-item--sale"
  , ".product-info__price .price .price__current"
  , ".wrap-product-info .priceSingle span.pr_price"
  , ".product-block--price .modal_price .price span.money"
  // , ".product-info .v-stack sale-price"
  , ".productView-details .productView-price .price__regular .price-item--regular" //Ella 6.5.4
  , ".productView-details .productView-price .price__sale .price-item--sale" //Ella 6.5.4
  , ".product-info__price .rating-with-text price-list sale-price"// Impact version 4.3.0
  , ".product-price-container ins .amount"
  , ".product__app-block + div .product__price .price__container ins.price_product" //Sahara 1.1.10
  , ".product__content div[id*='Product-Price-template'] ins.price_product"
  , ".product__info-container div.no-js-hidden[id*='price-template'] .price--on-sale .price__sale .price-item--sale"
  , "span[data-product-price].product__price.on-sale span" //Impulse 7.4.1
  , "span[data-product-price].product__price span" //Impulse 7.4.1
  , "span[data-product-price].product__price" //Impulse 7.4.1
  , ".yv-pricebox-outer .yv-product-price" //Yuva 12.1.0
  , ".product__title + div[id*='Product-Price-template--'] .price__regular .visually-hidden + span" //Sahara 1.1.10
  , ".product__info-container div.no-js-hidden[id*='price-template'] .price-item--regular bdi"
  , ".product-actions .product-price .product-price--original" //Local 2.3.2 64170688683
  , ".Product__InfoWrapper .Product__Info .ProductMeta__PriceList .ProductMeta__Price.Price" // Prestige version 4.1.0 61112254697
  , ".product-details-wrapper #ProductPrice span.money" // Flow version 33.0.0 59927363743
  , ".enj-product-price.engoj_price_main" // Janier version 1.0.0 82220450067
  , ".main-content div[data-product-type='price'] span.money" // PageFly 59252080811
  // , ".product__info-container .price__container > .price__regular .price-item.price-item--regular" // Dawn 87373545759
  , ".product-price .product-price__prices #ProductPrice" //unknow theme 86002729246
  , ".product__block__price .product__price__wrap span[data-product-price]"
  , ".product-block--title + .product-block--price .product-single__prices .product__price[data-product-price]" //Streamline 4.4.1 80845308239
  , ".price.product__price .price__current span.money[data-price]" // theme Empire 11.0.0 63207538849
  , ".product-block.product-block--price .product__price"  // Motion 10.4.1 71974158653
  , ".product-block.product-block--price .product-pricing[data-product-pricing] .price.product__price"  // Empire 9.1.1 52262240425
  , ".price.price--large  .price-item.price-item--last" // Shine 1.1.0 Page Fly
  , ".t4s-product__price-review .t4s-product-price ins" // theme Kalles version 4.0.4 64665092279
  , ".t4s-product__price-review .t4s-product-price span.money" // theme Kalles version 4.2.3 27888222286
  , ".product-info__price .price .price__default .price__current" // Enterprise version 1.4.0
  , ".price.price--large  .price-item.price-item--last" // Electro 1.4.0 Page Fly
  , ".product-single__form-price .product__price" // Expanse 1.0.5 59286225080
  , ".product-single__meta .price-main .product-single__price" // Velatheme 2.0.0 71189233952
  , ".product-final-total .total-price" // Velatheme 2.0.0 71189233952
  , ".product_details_info .price-block #ProductPrice span" // Spront 1.0.0 70102352088
  , ".price-container.text-money #ProductPrice span" // Debutify 3.0.4 57964363930
  , "#ProductSection .product-single .product-single__prices #ProductPrice" // Minimal 11.7.11 37274026115
  , ".product-block--price .price-container[data-price-container] .price-container__price .price-container__price span.money" // Retina 7.3.0 10944892
  , ".modal_price .price__container span .current_price .money" // 54942433488
  , ".product-info__block-item[data-block-type='price'] .price-list.price-list--product sale-price" // Prestige 10.0.0 68329144558
  , ".product-block-group--price .m-price__regular .m-price-item.m-price-item--regular" // Minimog - OS 2.0 70798901505
  , "#productPrice-product-template span[aria-hidden]" // Supply 8.5.0 25331662957
  , "div[id*=price-template] .main-product-price.price .price-sale" // Eurus 64108757169
  , ".price .price__text[id*=price-template] .price__number" //Venue 27289256036
  , ".product-detail__price span[data-product-price][data-product-detail-price] span" // Boost 27289256036
  , "#product-price .price__pricing-group .price__regular .price-item.price-item--regular"  //Forge 4.0.0 57510330564
  , ".product__price.product__block span[data-price]" // Spark 57017368679
  , ".product__price .price__pricing-group .price__regular span.price-item.price-item--regular" //Pursuit 1.1 

];
AvisOptionsConfig.productPriceHasSaleSelector = [
  ".price__sale s.price-item.price-item--regular"
  , ".ProductMeta__Price.Price.Price--compareAt"
  , ".product-block--price span[data-compare-price]"
  , ".product-block-group--price s.m-price-item.m-price-item--regular"
  , ".product-info__price .price s.price__was"
  , ".wrap-product-info .priceSingle s.pr_price"
  , ".product-block--price .modal_price .compare-at-price span.money"
  , ".product-info .v-stack compare-at-price"
  , ".productView-details .productView-price .price__sale .price__compare s" //Ella 6.5.4
  , ".product-price-container del .amount"
  , ".product__app-block + div .product__price .price__container del.price_compared" //Sahara 1.1.10
  , ".product__content div[id*='Product-Price-template'] del.price_compared"
  , ".product__info-container div.no-js-hidden[id*='price-template'] .price--on-sale .price__regular .price-item--regular"
  , ".product__info-container div.no-js-hidden[id*='price-template'] .price--on-sale .price__sale .price-item--regular"
  //, "span[data-compare-price].product__price.product__price--compare span" //Impulse 7.4.1
  , ".main-content div[data-product-type='compare_at_price'] span.money" // PageFly 59252080811
  , ".pdp-layout--hybrid div[data-product-blocks] .product-single__prices .product__price.product__price--compare" //Streamline 4.4.1 80845308239
  , ".price.product__price .price__current span.money[data-price-compare]" // theme Empire 11.0.0 63207538849
  , ".price.price--large .price-item.price-item--regular" // Shine 1.1.0 Page Fly
  , ".t4s-product__price-review .t4s-product-price del" // theme Kalles version 4.0.4 64665092279
  , ".product-info__price .price .price__default .price__was.price__was--supercents" // Enterprise version 1.4.0
  , ".price__sale .price-item.price-item--regular" // Electro 1.4.0 Page Fly
  , ".product_details_info .price-block #ComparePrice span" // Spront 1.0.0 70102352088
  , ".price-container.text-money #ComparePrice span" // Debutify 3.0.4 57964363930
  , ".product-info__block-item[data-block-type='price'] .price-list.price-list--product compare-at-price" // Prestige 10.0.0 68329144558
  , "div[id*=price-template] .main-product-price.price small s" // Eurus 64108757169
  , ".product__price.product__block s[data-compare-price]" // Spark 57017368679
  , ".product__price .price__pricing-group .price__sale span.price-item.price-item--sale" //Pursuit 1.1 
];
AvisOptionsConfig.productVariantPriceSelector = [
  ".product__info-container .price__container > .price__regular .price-item.price-item--regular" // theme shopify
  , ".al_center.price-review #price_ppr .current_price del" // theme Kalles 2.7.1
  , ".al_center.price-review #price_ppr .current_price" // theme Kalles 2.7.1
  , ".al_center.price-review #price_ppr del" // theme Kalles 2.7.1
  , ".al_center.price-review #price_ppr" // theme Kalles 2.7.1
  , ".product-form__info-item .price-list .price" // theme Warehouse v2.8.2, v1.16.4
  , ".tt-price .new-price" // theme Wokiee version 2.2.2 shopify 2.0
  , ".ecom-product-single__price--sale" // key ECom
  , ".ecom-product-single__price--regular" // key ECom
  , ".product-info__price .rating-with-text price-list compare-at-price span.money" // theme Impact version 4.3.0
  , ".f-price__regular .f-price-item.f-price-item--regular" // theme Minimog - OS 2.0 version 3.4.0
  , ".product-form.theme-init .price-container .current-price.theme-money" // Symmetry version 5.6.0
  , ".f8pr .f8pr-price.price span.money" // Xtra version 4.0.0 available
  , ".product-single__primary-blocks .price__number .notranslate.ht-money" // Venue version 10.0.5 available
  , ".price__pricing-group .price__regular .price-item.price-item--regular" // Testament version 12.2.0 available
  // , ".product-info .v-stack sale-price" // Prestige version 8.2.0
  //,"span[data-product-price].product__price" // Motion version 10.4.0
  , "div.price-container div.variant-visibility-area div.price-area .price span" // Symmetry version 6.0.3
  , ".product-price-container .etrans-money" // Reformation version 1.6.2
  , ".price .current-price" // Athens version 2.0.0
  , ".product--page .product-price__current-price" // Aurora version 3.0.2
  , ".main-product__block-price .m-price__regular .m-price-item--regular"
  , "form.shopify-product-form .items-end.justify-between span[x-show='defaultVariantPrice > 0']"
  , ".product-single__price" //Minimal 12.0.2
  , ".product--price .price--main span.money"  //Superstore 5.1.0
  , ".price__container .price__item" //Area 1.3.3
  , ".price.price--medium .price__last .price-item.price-item--regular" //Ella 6.5.5
  , ".halo-productView-right .price__regular .price-item.price-item--regular" //Ella 6.5.4
];
AvisOptionsConfig.productVariantPriceSaleSelector = [
  ".product__info-container .price__container .price-item--sale" // theme shopify
  , ".al_center.price-review #price_ppr .current_price ins" // theme Kalles 2.7.1
  , ".al_center.price-review #price_ppr .current_price" // theme Kalles 2.7.1
  , ".al_center.price-review #price_ppr ins" // theme Kalles 2.7.1
  , ".product-form__info-item .price-list .price.price--highlight" // theme Warehouse v2.8.2, v1.16.4
  , ".tt-price .sale-price" // theme Wokiee version 2.2.2 shopify 2.0
  , ".ecom-product-single__price--sale" // key ECom
  , ".product-info__price .rating-with-text price-list sale-price span.money" // theme Impact version 4.3.0
  , ".product-form.theme-init .price-container .was-price.theme-money" // Symmetry version 5.6.0
  , ".price__pricing-group .price__sale .price-item.price-item--regular" // Testament version 12.2.0 available
  //,".product-info__price .price .price__default .price__current" // Enterprise version 1.4.1
  , ".main-product__block-price .m-price__sale .m-price-item--regular"
  , "form.shopify-product-form .items-end.justify-between s[x-show='defaultVariantComparePrice > 0']"
  , ".product-info .v-stack compare-at-price" // Prestige version 8.2.0
];
AvisOptionsConfig.productVariantShowPriceSaleSelector = [
  {
    key: ".product__info-container .price--show-badge", // theme shopify
    sale: "price--on-sale",
    soldOut: "price--sold-out"
  }
];

function apoInitOptions() {
  AvisOptionsData = AvisOptionsData || {};
  AvisOptionsData.createModalPopup = function (option) {
    function removeModal() {
      let modalPopups = document.querySelectorAll(".apo-modal");
      if (modalPopups.length > 0) {
        for (let modalItem of modalPopups) {
          modalItem.remove();
        }
      }
    }
    removeModal();
    let divModal = document.createElement("div");
    divModal.classList.add("apo-modal");

    let divContainer = document.createElement("div");
    divContainer.classList.add("apo-modal__container");
    if (option?.size_modal)
      divContainer.setAttribute("style", `width: ${option?.size_modal}px`);

    let divWrapper = document.createElement("div");
    divWrapper.classList.add("apo-modal__wrapper");
    divWrapper.innerHTML = `
      ${option?.title_modal
        ? `<div class="apo-modal__heading">${option?.title_modal}</div>`
        : ""
      }
      <div class="apo-modal__content">
          ${option?.rich_text_value_modal ?? ""}
      </div>`;

    let spanClose = document.createElement("span");
    spanClose.classList.add("apo-close__modal");
    spanClose.innerHTML = "&times;";

    spanClose.addEventListener("click", function () {
      removeModal();
    });
    divContainer.append(spanClose);
    divContainer.append(divWrapper);
    divModal.append(divContainer);

    return divModal;
  };
}
apoInitOptions();

function apoInitOptionsSizeChart() {
  AvisOptionsData = AvisOptionsData || {};
  AvisOptionsData.createModalSizeChart = function (option) {
    function removeModal() {
      let modalPopups = document.querySelectorAll(".apo-modal");
      if (modalPopups.length > 0) {
        for (let modalItem of modalPopups) {
          modalItem.remove();
        }
      }
    }
    removeModal();
    let divModal = document.createElement("div");
    divModal.classList.add("apo-modal");

    let divContainer = document.createElement("div");
    divContainer.classList.add("apo-modal__container");
    if (option?.size_modal_size_chart)
      divContainer.setAttribute(
        "style",
        `width: ${option?.size_modal_size_chart}px`
      );

    let divWrapper = document.createElement("div");
    divWrapper.classList.add("apo-modal__wrapper");
    divWrapper.innerHTML = `
        ${option?.chart_header
        ? `<div class="apo-modal__heading">${option?.chart_header}</div>`
        : ""
      }
        <div class="apo-modal__content content-size__chart">
            ${option?.rich_text_value_size_chart ?? ""}
        </div>`;

    let spanClose = document.createElement("span");
    spanClose.classList.add("apo-close__modal");
    spanClose.innerHTML = "&times;";

    spanClose.addEventListener("click", function () {
      removeModal();
    });
    divContainer.append(spanClose);
    divContainer.append(divWrapper);
    divModal.append(divContainer);

    return divModal;
  };
}
apoInitOptionsSizeChart();

var AvisOptionsConfigApp = window.ap_front_settings;
var onAppendPriceToVariant =
  AvisOptionsConfigApp?.config?.config_app?.product_page?.add_price_to_variant;
function apoAppendPriceToVariant(areaGenAvisOptionSelector, productInfo) {
  let shop_id = window.ap_front_settings.shop_id;
  if (!areaGenAvisOptionSelector) areaGenAvisOptionSelector = document;
  let formSelectors = areaGenAvisOptionSelector.querySelectorAll(
    "form[action$='/cart/add']"
  );

  if (!productInfo) {
    productInfo = AvisOptionsConfigApp?.product_info?.product;
  }

  if (!formSelectors || formSelectors.length === 0) return;

  const appendPriceToVariant = (
    formVariantSelector,
    formTotalAddChargeSelector,
    quantitySelector = null
  ) => {
    variantIdSelected = formVariantSelector.value;
    let product = productInfo
      ? productInfo
      : window.ap_front_settings.product_info.product;
    // let productId = productInfo ? productInfo.id : "default";
    if (product) {
      if (formVariantSelector) {
        let variant = product.variants.find(
          (e) => String(e.id) === String(formVariantSelector.value)
        );
        if (!variant) variant = product.variants[0];
        if (variant) {
          let variantPrice = variant.price;
          let variantComparePrice = variant.price;
          let isSale = false;
          let isSoldOut = !variant.available;
          if (variant.compare_at_price > variant.price) {
            isSale = true;
            variantComparePrice = variant.compare_at_price;
          }

          if (shop_id === "69043421407" && quantitySelector) {
            try {
              variantPrice = variantPrice * parseInt(quantitySelector.value);
              variantComparePrice = variantComparePrice * parseInt(quantitySelector.value);
            } catch (e) { console.log(e) }
          }

          let totalPriceAddCharge = parseFloat(
            formTotalAddChargeSelector?.value ?? 0
          );
          if (totalPriceAddCharge > 0) {
            variantPrice += totalPriceAddCharge;
            variantComparePrice += totalPriceAddCharge;
          }
          let filterProductPrice = areaGenAvisOptionSelector;
          let isAppendPrice = false;
          let isFindPrice = false;
          {
            switch (shop_id) {
              case "63207538849":
                isFindPrice = false;
                if (
                  filterProductPrice.querySelectorAll(".apo-variant-price").length === 0
                ) {
                  for (let itemKey of AvisOptionsConfig.productVariantPriceWrapperSelector) {
                    let elem = filterProductPrice.querySelector(itemKey + ":not(.apo-variant-price)");
                    if (elem) {
                      const clone = elem.cloneNode(true);
                      clone.classList.add("apo-variant-price");
                      elem.parentNode.insertBefore(clone, elem.nextSibling);
                      isFindPrice = true;
                      break;
                    }
                  }
                  if (!isFindPrice) {
                    console.log("APO not found append product price");
                    return;
                  }
                }
                break;

              case "1991066":
                isFindPrice = false;
                if (
                  filterProductPrice.querySelectorAll(".apo-variant-price").length === 0
                ) {
                  for (let itemKey of AvisOptionsConfig.productVariantPriceWrapperSelector) {
                    let elem = filterProductPrice.querySelector(itemKey + ":not(.apo-variant-price)");
                    if (elem) {
                      elem.classList.add("apo-variant-price");
                      isFindPrice = true;
                      break;
                    }
                  }
                  if (!isFindPrice) {
                    console.log("APO not found append product price");
                    return;
                  }
                }
                break;


              default:
                let htmlNotVariant = AvisOptionsConfig.productVariantPriceWrapperSelector.join(
                  ":not(.apo-variant-price),"
                ) + ":not(.apo-variant-price)";
                let productPriceWrapperSelector =
                  filterProductPrice.querySelectorAll(htmlNotVariant);
                if (productPriceWrapperSelector.length === 0) {
                  console.log("APO not found append product price");
                  return;
                }

                if (
                  filterProductPrice.querySelectorAll(".apo-variant-price")
                    .length === 0 &&
                  productPriceWrapperSelector &&
                  productPriceWrapperSelector.length > 0) {
                  productPriceWrapperSelector.forEach(function (elem, e) {
                    const clone = elem.cloneNode(true);
                    clone.classList.add("apo-variant-price");
                    elem.parentNode.insertBefore(clone, elem.nextSibling);
                  });
                }
                break;
            }
          }
          // Append price V2
          {
            // Append price
            switch (shop_id) {
              case "63207538849":
                for (let itemSelector of AvisOptionsConfig.productPriceSelector) {
                  let currentPriceSelector = filterProductPrice.querySelector(itemSelector);
                  if (currentPriceSelector) {
                    isAppendPrice = true;
                    let formatPrice =
                      AvisOptionsConfig?.priceMod?.formatMoney(variantPrice);
                    if (currentPriceSelector?.innerHTML?.trim() && currentPriceSelector.innerHTML != formatPrice) {
                      currentPriceSelector.innerHTML = formatPrice;
                    }
                  }
                }
                break;
              default:
                let currentPriceSelector = filterProductPrice.querySelectorAll(
                  AvisOptionsConfig.productPriceSelector.join(",")
                );
                if (currentPriceSelector.length > 0) {
                  isAppendPrice = true;
                  currentPriceSelector.forEach(function (elem, e) {
                    let formatPrice =
                      AvisOptionsConfig?.priceMod?.formatMoney(variantPrice);
                    if (elem?.innerHTML?.trim() && elem.innerHTML != formatPrice) {
                      elem.innerHTML = formatPrice;
                    }
                  });
                }
                break;
            }


            // Append price has sale
            for (let itemSelector of AvisOptionsConfig.productPriceHasSaleSelector) {
              let currentPriceSelectors = filterProductPrice.querySelectorAll(itemSelector);
              for (let currentPriceSelector of currentPriceSelectors) {
                let formatPrice =
                  AvisOptionsConfig?.priceMod?.formatMoney(variantComparePrice);
                if (currentPriceSelector?.innerHTML?.trim() && currentPriceSelector.innerHTML != formatPrice) {
                  currentPriceSelector.innerHTML = formatPrice;
                }
              }
            }
          }
          if (isAppendPrice) return;
          // Append price V1
          {
            // Show/Hide Sale or sold out
            AvisOptionsConfig.productVariantShowPriceSaleSelector.forEach(
              (e, index) => {
                let showSaleSelector = filterProductPrice.querySelectorAll(
                  e.key
                );
                if (showSaleSelector && showSaleSelector.length > 0) {
                  if (e.sale) {
                    showSaleSelector.forEach((elem, indexElem) => {
                      if (isSale) elem.classList.add(e.sale);
                      else elem.classList.remove(e.sale);
                    });
                  }
                  if (e.soldOut) {
                    showSaleSelector.forEach((elem, indexElem) => {
                      if (isSoldOut) elem.classList.add(e.soldOut);
                      else elem.classList.remove(e.soldOut);
                    });
                  }
                }
              }
            );

            // Append price normal
            if (shop_id === "79438512462") {
              let productPriceSelector = filterProductPrice.querySelectorAll(
                ".product-info__price .price .price__default .price__was"
              );
              if (productPriceSelector && productPriceSelector.length > 0) {
                productPriceSelector.forEach(function (elem, e) {
                  let formatPrice =
                    AvisOptionsConfig?.priceMod?.formatMoney(
                      variantComparePrice
                    );
                  if (elem.innerHTML && elem.innerHTML != formatPrice) {
                    elem.innerHTML = formatPrice;
                  }
                });
              }
            } else {
              if (shop_id === "28248932457") {
                let formatPrice =
                  AvisOptionsConfig?.priceMod?.formatMoney(variantPrice);
                for (let keySelector of AvisOptionsConfig.productVariantPriceSelector) {
                  let productPriceSelector =
                    filterProductPrice.querySelectorAll(keySelector);
                  if (productPriceSelector && productPriceSelector.length > 0) {
                    productPriceSelector.forEach(function (elem, e) {
                      if (
                        elem?.innerHTML?.trim() &&
                        elem.innerHTML != formatPrice
                      ) {
                        elem.innerHTML = formatPrice;
                      }
                    });
                    break;
                  }

                  let buttonAddCartPrice = document.querySelector(
                    "form.shopify-product-form .btn__content span[x-show='calculatedPrice > 0']"
                  );
                  if (buttonAddCartPrice) {
                    if (
                      buttonAddCartPrice?.innerHTML?.trim() &&
                      buttonAddCartPrice.innerHTML != formatPrice
                    ) {
                      buttonAddCartPrice.innerHTML = formatPrice;
                    }
                  }
                }

                if (isSale) {
                  let productPriceSelector =
                    filterProductPrice.querySelectorAll(
                      AvisOptionsConfig.productVariantPriceSaleSelector.join(
                        ","
                      )
                    );
                  if (productPriceSelector && productPriceSelector.length > 0) {
                    productPriceSelector.forEach(function (elem, e) {
                      let formatPrice =
                        AvisOptionsConfig?.priceMod?.formatMoney(
                          variantComparePrice
                        );
                      if (
                        elem?.innerHTML?.trim() &&
                        elem.innerHTML != formatPrice
                      ) {
                        elem.innerHTML = formatPrice;
                      }
                    });
                  } else {
                    console.log("Not found price selector of product variant");
                  }
                }
                return;
              } else
                for (let keySelector of AvisOptionsConfig.productVariantPriceSelector) {
                  let productPriceSelector =
                    filterProductPrice.querySelectorAll(keySelector);
                  if (productPriceSelector && productPriceSelector.length > 0) {
                    productPriceSelector.forEach(function (elem, e) {
                      let formatPrice =
                        AvisOptionsConfig?.priceMod?.formatMoney(
                          variantComparePrice
                        );
                      if (
                        elem?.innerHTML?.trim() &&
                        elem.innerHTML != formatPrice
                      ) {
                        elem.innerHTML = formatPrice;
                      }
                    });
                    break;
                  }
                }
            }

            // Append price sale
            if (isSale || shop_id === "79438512462") {
              let productPriceSelector = filterProductPrice.querySelectorAll(
                AvisOptionsConfig.productVariantPriceSaleSelector.join(",")
              );
              if (productPriceSelector && productPriceSelector.length > 0) {
                productPriceSelector.forEach(function (elem, e) {
                  let formatPrice =
                    AvisOptionsConfig?.priceMod?.formatMoney(variantPrice);
                  if (
                    elem?.innerHTML?.trim() &&
                    elem.innerHTML != formatPrice
                  ) {
                    elem.innerHTML = formatPrice;
                  }
                });
              } else {
                console.log("Not found price selector of product variant");
              }
            }
          }
        }
      } else console.log("Not found variant id");
    }
  };
  let formSelectorHasAddToCart = null;
  let formVariantSelector = null;
  let formTotalAddChargeSelector = null;
  let variantIdSelected = false;
  let intervalVariantId = setInterval(() => {
    if (!AvisOptionsConfig?.priceMod?.formatMoney) return;

    for (let elm of formSelectors) {
      let buttonAddCart = elm.querySelector(
        AvisOptionsConfig.listKeyButtonAddCart.join(",")
      );
      let isSelect = false;
      if (buttonAddCart || shop_id === "77048054095") {
        formSelectorHasAddToCart = elm;
        formVariantSelector =
          formSelectorHasAddToCart.querySelector("input[name='id']");
        if (!formVariantSelector) {
          formVariantSelector =
            formSelectorHasAddToCart.querySelector("select[name='id']");
          if (formVariantSelector) isSelect = true;
        }

        if (!formVariantSelector && formSelectorHasAddToCart?.id?.className) {
          formVariantSelector = document.querySelector(
            `input[name='id'].${formSelectorHasAddToCart?.id?.className}`
          );
        }

        if (formVariantSelector) {
          variantIdSelected = formVariantSelector.value;
          let intervalTotalAddCharge = setInterval(() => {
            formTotalAddChargeSelector =
              areaGenAvisOptionSelector.querySelector(
                "input.apo-total-addcharge"
              );
            let quantitySelector = formSelectorHasAddToCart.querySelector("input[name='quantity']");
            if (formTotalAddChargeSelector) {
              appendPriceToVariant(
                formVariantSelector,
                formTotalAddChargeSelector,
                quantitySelector
              );
              new MutationObserver(() => {
                appendPriceToVariant(
                  formVariantSelector,
                  formTotalAddChargeSelector,
                  quantitySelector
                );
              }).observe(formVariantSelector, {
                attributes: true,
                childList: true,
                subtree: true,
              });
              new MutationObserver(() => {
                appendPriceToVariant(
                  formVariantSelector,
                  formTotalAddChargeSelector,
                  quantitySelector
                );
              }).observe(formTotalAddChargeSelector, {
                attributes: true,
                childList: true,
                subtree: true,
              });
              if (isSelect) {
                setInterval(function () {
                  if (variantIdSelected != formVariantSelector.value) {
                    variantIdSelected = formVariantSelector.value;
                    appendPriceToVariant(
                      formVariantSelector,
                      formTotalAddChargeSelector,
                      quantitySelector
                    );
                  }
                }, 100);
              }
              if (shop_id === "69043421407") {
                let quantityOld = 0;
                setInterval(function () {
                  if (quantitySelector.value !== quantityOld) {
                    quantityOld = quantitySelector.value;
                    appendPriceToVariant(
                      formVariantSelector,
                      formTotalAddChargeSelector,
                      quantitySelector
                    );
                  }
                }, 200);
              }
              clearInterval(intervalTotalAddCharge);
            }
            else if (shop_id === "63207538849") {
              appendPriceToVariant(
                formVariantSelector,
                formTotalAddChargeSelector,
                quantitySelector
              );
              new MutationObserver(() => {
                appendPriceToVariant(
                  formVariantSelector,
                  formTotalAddChargeSelector,
                  quantitySelector
                );
              }).observe(formVariantSelector, {
                attributes: true,
                childList: true,
                subtree: true,
              });
              clearInterval(intervalTotalAddCharge);
            }
          }, 300);
        } else {
          console.log("APO not found input id for append price to variant");
        }
        clearInterval(intervalVariantId);
        break;
      }
    }
  }, 300);
}

if (onAppendPriceToVariant && AvisOptionsConfigApp?.page_type === "product") {
  apoAppendPriceToVariant();
}

function apoAppendQuickview() {
  async function appendOptionToQuickview(buttonQuickviewSelector) {
    let formQuickview = document.querySelector(
      AvisOptionsConfig.quick_view.quickViewModal
    );
    AvisOptionsData.formProductQuickview = formQuickview;

    if (!formQuickview) return;

    let hrefProduct = buttonQuickviewSelector.getAttribute("data-product-url");
    if (!hrefProduct) {
      let productCardItem = buttonQuickviewSelector.closest("product-card");
      if (productCardItem) {
        hrefProduct = productCardItem.getAttribute("data-url");
      }
    }
    if (!hrefProduct) {
      hrefProduct = buttonQuickviewSelector.getAttribute("href");
    }
    if (!hrefProduct) {
      hrefProduct =
        buttonQuickviewSelector.closest(".product-card__figure") &&
        buttonQuickviewSelector
          .closest(".product-card__figure")
          .querySelector('a[href*="/products/"]')
          ?.getAttribute("href");
    }
    if (!hrefProduct) {
      hrefProduct =
        buttonQuickviewSelector.closest(".grid__item.product-item") &&
        buttonQuickviewSelector
          .closest(".grid__item.product-item")
          .querySelector('a[href*="/products/"]')
          ?.getAttribute("href");
    }

    if (!hrefProduct || hrefProduct === "javascript:void(0);") {
      hrefProduct =
        buttonQuickviewSelector.closest(".st-col-item") &&
        buttonQuickviewSelector
          .closest(".st-col-item")
          .querySelector('a[href*="/products/"]')
          ?.getAttribute("href");
    }

    if (!hrefProduct) {
      hrefProduct =
        buttonQuickviewSelector?.getAttribute("data-url")
    }

    if (!hrefProduct) {
      hrefProduct =
        buttonQuickviewSelector?.getAttribute("data-product-url")
    }

    if (!hrefProduct) {
      hrefProduct =
        buttonQuickviewSelector.closest("product-item") &&
        buttonQuickviewSelector.closest("product-item").querySelector('a[href*="/products/"]')?.getAttribute("href");
    }

    if (hrefProduct?.indexOf("/") === -1) {
      hrefProduct = null
    }

    let handleProduct = hrefProduct
      ? hrefProduct
        .substring(hrefProduct.lastIndexOf("/"))
        .replace("/", "")
        .split("?")[0]
      : null;
    if (!handleProduct) {
      handleProduct = buttonQuickviewSelector
        .closest("[data-handle]")
        ?.getAttribute("data-handle");
    }
    if (!handleProduct) {
      handleProduct = buttonQuickviewSelector?.getAttribute("data-product-handle");
    }
    if (!handleProduct) {
      handleProduct = buttonQuickviewSelector?.getAttribute("data-id");
    }
    if (!handleProduct) {
      handleProduct = buttonQuickviewSelector?.getAttribute("handle");
    }
    if (handleProduct) {
      let productInfo = await AvisOptionsData.pluginAction.getProduct(
        handleProduct
      );
      if (productInfo) {
        let genAvisOptionInterval = setInterval(function () {
          let findForm = formQuickview.querySelector(window.AP_POptions.listKeyAppendOptionPG);
          if (findForm) {
            AvisOptionsData.mainCheckAllRules(
              productInfo,
              productInfo.id + "_quickview",
              false,
              formQuickview
            );
            if (onAppendPriceToVariant)
              apoAppendPriceToVariant(formQuickview, productInfo);
            clearInterval(genAvisOptionInterval);
          }
        }, 200);
      }
    }
  }
  let quickViewSubmit =
    AvisOptionsConfig.quick_view.quickViewButtonSubmit.join(",");
  let intervalCheckQuickview = setInterval(function () {
    if (document.querySelectorAll(quickViewSubmit).length > 0) {
      //clearInterval(intervalCheckQuickview);
      document.querySelectorAll(quickViewSubmit).forEach(function (elem) {
        elem.classList.add("apo-quickview");
        elem.addEventListener("click", function (event) {
          let isOpen = false;
          let interval = setInterval(() => {
            if (
              !isOpen &&
              document.querySelectorAll(
                AvisOptionsConfig.quick_view.quickViewModal
              ).length > 0
            ) {
              isOpen = true;
              appendOptionToQuickview(elem);
              clearInterval(interval);
            }
          }, 300);
        });
      });
    }
  }, 300);
}
if (AvisOptionsData?.show_quickview && AvisOptionsConfigApp?.page_type !== "product") {
  apoAppendQuickview();
}

function apoAppendFeaturedProduct() {
  let sectionFeatured = AvisOptionsConfig.featured_product.join(",");
  let sectionFeaturedSelectors = document.querySelectorAll(sectionFeatured);
  if (sectionFeaturedSelectors && sectionFeaturedSelectors.length > 0) {
    let intervalFeatured = setInterval(function () {
      let isOpen = false;
      if (!isOpen && AvisOptionsData.mainCheckAllRules) {
        isOpen = true;
        clearInterval(intervalFeatured);
        sectionFeaturedSelectors.forEach(async function (
          sectionFeaturedSelector
        ) {
          let productInfo = null;
          let shop_id = window.ap_front_settings.shop_id;
          if (shop_id === "64130056412") {
            let productInfoSelector =
              sectionFeaturedSelector.closest(".shopify-section");
            if (productInfoSelector) {
              let productSelector = productInfoSelector.querySelector(
                "[data-section-type='featured-product']"
              );
              if (productSelector) {
                let strProduct = productSelector.innerText;
                if (strProduct) {
                  try {
                    let allData = JSON.parse(strProduct);
                    productInfo = allData?.product;
                  } catch (e) {
                    return;
                  }
                }
              }
            }
          } else if (shop_id === "34557722763") {
            let productSelector =
              sectionFeaturedSelector.querySelector("script");
            if (productSelector) {
              let strProduct = productSelector.innerText;
              if (strProduct) {
                try {
                  let allData = JSON.parse(strProduct);
                  let hrefProduct = allData?.url;
                  let handleProduct = hrefProduct
                    .substring(hrefProduct.lastIndexOf("/"))
                    .replace("/", "")
                    .split("?")[0];
                  if (!handleProduct) return;
                  productInfo = await AvisOptionsData.pluginAction.getProduct(
                    handleProduct
                  );
                } catch (e) {
                  return;
                }
              }
            }
          } else {
            let productSelector = sectionFeaturedSelector.querySelector(
              "script[id*='product-json']"
            );
            if (productSelector) {
              let strProduct = productSelector.innerText;
              if (strProduct) {
                try {
                  productInfo = JSON.parse(strProduct);
                } catch (e) {
                  return;
                }
              }
            } else {
              let productInfoSelector = sectionFeaturedSelector.querySelector(
                "product-info,variant-radios,product-variants"
              );
              // if (!productInfoSelector) return;

              let hrefProduct = productInfoSelector?.getAttribute("data-url");
              if (!hrefProduct) {
                hrefProduct = sectionFeaturedSelector.querySelector("meta[itemprop='url']")?.getAttribute("content");
              }
              if (!hrefProduct) {
                hrefProduct = sectionFeaturedSelector?.getAttribute("data-product-url")
              }
              if (!hrefProduct) {
                hrefProduct = sectionFeaturedSelector.querySelector(".pe-no-link")?.getAttribute("href");
              }
              if (!hrefProduct) {
                hrefProduct = sectionFeaturedSelector.querySelector(".product-info__title.h2 a")?.getAttribute("href");
              }
              if (!hrefProduct) {
                hrefProduct = sectionFeaturedSelector.closest("product-info") &&
                  sectionFeaturedSelector
                    .closest("product-info")?.getAttribute("data-url");
              }
              if (!hrefProduct) {
                hrefProduct = sectionFeaturedSelector.querySelector("meta[itemprop='url']")?.getAttribute("content");
              }
              if (!hrefProduct) {
                hrefProduct = sectionFeaturedSelector.querySelector("media-gallery")?.getAttribute("data-product-url");
              }
              let handleProduct = hrefProduct
                ?.substring(hrefProduct?.lastIndexOf("/"))
                .replace("/", "")
                .split("?")[0];
              if (!handleProduct) return
              productInfo = await AvisOptionsData.pluginAction.getProduct(
                handleProduct
              );
            }
          }

          if (productInfo) {
            AvisOptionsData.mainCheckAllRules(
              productInfo,
              productInfo.id + "_featured",
              false,
              sectionFeaturedSelector
            );
            if (onAppendPriceToVariant)
              apoAppendPriceToVariant(sectionFeaturedSelector, productInfo);
          }
        });
      }
    }, 200);
  }
}
if (AvisOptionsData?.show_featured && AvisOptionsConfigApp?.page_type !== "product") {
  apoAppendFeaturedProduct();
}

function apoOptionsCustomAccordion() {
  var shopDomain = window.Shopify.shop;
  if (
    shopDomain === "hoang-test-so.myshopify.com" ||
    shopDomain === "prodesksim.myshopify.com" ||
    shopDomain === "hoang-apo-v3.myshopify.com" ||
    shopDomain === "388139-7.myshopify.com" ||
    shopDomain === "545404-0b.myshopify.com"
  ) {
    function addJQuery() {
      var script = document.createElement("script");
      script.src = "https://code.jquery.com/jquery-3.6.0.min.js";
      script.type = "text/javascript";
      script.onload = function () {
        $("#example-element").text("Hello, jQuery!");
      };
      document.head.appendChild(script);
    }
    addJQuery();

    setInterval(function () {
      let apElements = document.querySelector("#avpoptions-container__v2");
      if (apElements) {
        let avpoAccordionMultipleItems = document.querySelectorAll(
          ".avpo-accordion-multiple-items .ap-label-tooltip"
        );
        let avpoAccordionOptionItems = document.querySelectorAll(
          ".avpo-accordion-multiple-items > span"
        );

        for (let i = 0; i < avpoAccordionMultipleItems.length; i++) {
          let checkExist = avpoAccordionOptionItems[i].parentNode.querySelector(
            ".avpo-accordion-item"
          );
          $(avpoAccordionMultipleItems[i]).click(function () {
            if (!checkExist) {
              avpoAccordionOptionItems[i].classList.add("avpo-accordion-item");
            }
            if (checkExist) {
              avpoAccordionOptionItems[i].removeAttribute("class");
            }
          });
        }
      }
    }, 100);
  }
}

apoOptionsCustomAccordion();

function apoOptionsCustomRadioWImage() {
  var shopDomain = window.Shopify.shop;
  if (
    (shopDomain === "hoang-apo-test-v3.myshopify.com" ||
      shopDomain === "samadhi-tea.myshopify.com" ||
      shopDomain === "hoang-apo-v3.myshopify.com" ||
      shopDomain === "5266e4-60.myshopify.com") &&
    (window.ap_front_settings.config.config_app.appPlan === "ADVANCED" ||
      window.ap_front_settings.config.config_app.appPlan === "PREMIUM")
  ) {
    function addJQuery() {
      var script = document.createElement("script");
      script.src = "https://code.jquery.com/jquery-3.6.0.min.js";
      script.type = "text/javascript";
      script.onload = function () {
        $("#example-element").text("Hello, jQuery!");
      };
      document.head.appendChild(script);
    }
    addJQuery();
    setInterval(function () {
      let apElements = document.querySelector("#avpoptions-container__v2");
      if (apElements) {
        if (
          document.querySelector(".apo-customize__radio--witch_single-swtach")
        ) {
          for (let keys of $(
            ".apo-customize__radio--witch_single-swtach span.money"
          )) {
            $(keys).html($(keys).html().replace("(", " ").replace(")", " "));
          }
          for (
            let i = 0;
            i <
            $(".apo-customize__radio--witch_single-swtach input[type='radio']")
              .length;
            i++
          ) {
            if (
              $(
                $(
                  ".apo-customize__radio--witch_single-swtach input[type='radio']"
                )[i]
              ).is(":checked") == true
            ) {
              $(
                $(
                  ".apo-customize__radio--witch_single-swtach input[type='radio']"
                )[i]
              ).attr("checked", "checked");
              $(
                $(
                  ".apo-customize__radio--witch_single-swtach label.avp-productoptionswatchwrapper"
                )[i]
              ).css("background", "#f5fffc");
              $(
                $(
                  ".apo-customize__radio--witch_single-swtach label.avp-productoptionswatchwrapper"
                )[i]
              ).css("border-color", "#008060");
            }
            if (
              $(
                $(
                  ".apo-customize__radio--witch_single-swtach input[type='radio']"
                )[i]
              ).is(":checked") == false
            ) {
              $(
                $(
                  ".apo-customize__radio--witch_single-swtach input[type='radio']"
                )[i]
              ).removeAttr("checked");
              $(
                $(
                  ".apo-customize__radio--witch_single-swtach label.avp-productoptionswatchwrapper"
                )[i]
              ).css("background", "transparent");
              $(
                $(
                  ".apo-customize__radio--witch_single-swtach label.avp-productoptionswatchwrapper"
                )[i]
              ).css("border-color", "#cccccc");
            }
          }
        }
        // Add background color checkbox
        if (
          document.querySelector(".apo-customize__radio--witch_multiple-swtach")
        ) {
          for (let keys of $(
            ".apo-customize__radio--witch_multiple-swtach span.money"
          )) {
            $(keys).html($(keys).html().replace("(", " ").replace(")", " "));
          }
          for (
            let i = 0;
            i <
            $(
              ".apo-customize__radio--witch_multiple-swtach label input[type='checkbox']"
            ).length;
            i++
          ) {
            if (
              $(
                $(
                  ".apo-customize__radio--witch_multiple-swtach input[type='checkbox']"
                )[i]
              ).is(":checked") == true
            ) {
              $(
                $(
                  ".apo-customize__radio--witch_multiple-swtach input[type='checkbox']"
                )[i]
              ).attr("checked", "checked");
              $(
                $(
                  ".apo-customize__radio--witch_multiple-swtach label.avp-productoptionswatchwrapper"
                )[i]
              ).css("background", "#f5fffc");
              $(
                $(
                  ".apo-customize__radio--witch_multiple-swtach label.avp-productoptionswatchwrapper"
                )[i]
              ).css("border-color", "#008060");
            }
            if (
              $(
                $(
                  ".apo-customize__radio--witch_multiple-swtach input[type='checkbox']"
                )[i]
              ).is(":checked") == false
            ) {
              $(
                $(
                  ".apo-customize__radio--witch_multiple-swtach input[type='checkbox']"
                )[i]
              ).removeAttr("checked");
              $(
                $(
                  ".apo-customize__radio--witch_multiple-swtach label.avp-productoptionswatchwrapper"
                )[i]
              ).css("background", "transparent");
              $(
                $(
                  ".apo-customize__radio--witch_multiple-swtach label.avp-productoptionswatchwrapper"
                )[i]
              ).css("border-color", "#cccccc");
            }
          }
        }
      }
    }, 100);
  } else {
    setInterval(function () {
      let apElements = document.querySelector("#avpoptions-container__v2");
      if (apElements) {
        document.querySelectorAll('.avp-option.ap-options__swatch-container').forEach(element => {
          element.classList.remove("apo-customize__radio--witch_single-swtach");
        })
      }
    }, 100)
  }
}

apoOptionsCustomRadioWImage();

function apoHideDropDownPrice() {
  let shopDomain = window.Shopify.shop;
  if (
    shopDomain === "50d919-5.myshopify.com" ||
    shopDomain === "jesse-strong-foundation.myshopify.com" ||
    shopDomain === "imparfait.myshopify.com" ||
    shopDomain === "atelier-imparfait.myshopify.com" ||
    shopDomain === "dipyourcar-com.myshopify.com" ||
    shopDomain === "8bd9e6-0a.myshopify.com" ||
    shopDomain === "62ca88-0c.myshopify.com" ||
    shopDomain === "skill-state.myshopify.com" ||
    shopDomain === "7782c8-8f.myshopify.com" ||
    shopDomain === "42914c-d3.myshopify.com" ||
    shopDomain === "arianaindia.myshopify.com"
  ) {
    let interval = setInterval(function () {
      let apElements = document.querySelector("#avpoptions-container__v2");
      if (apElements) {
        let optionMonneys = document.querySelectorAll(
          "#avpoptions-container__v2 .avp-option.ap-options__select-container span.money"
        );

        for (let key of optionMonneys) {
          key.innerHTML = "";
        }
        clearInterval(interval);
      }
    }, 100);
  }
}

apoHideDropDownPrice();

function apoOptionsCustomSwatchQuantity() {
  setInterval(function () {
    let apElements = document.querySelector(".avpoptions-container__v2");
    if (
      apElements &&
      document.querySelectorAll(".customize-swtach__quantity")
    ) {
      let inputItems = document.querySelectorAll(
        ".customize-swtach__quantity input.avp-productoptiontextcolor"
      );
      for (let inputItem of inputItems) {
        if (inputItem.checked) {
          inputItem.parentElement.parentElement.parentElement.classList.add(
            "apo-checked"
          );
          inputItem.parentElement.parentElement.nextElementSibling.style.display =
            "block";
        } else {
          inputItem.parentElement.parentElement.parentElement.classList.remove(
            "apo-checked"
          );
          inputItem.parentElement.parentElement.nextElementSibling.style.display =
            "none";
        }
      }
    }
  }, 100);
}

apoOptionsCustomSwatchQuantity();

function apoOptionsResponsiveTooltip() {
  setInterval(function () {
    let labelTooltips = document.querySelectorAll(
      "#avpoptions-container__v2 .ap-label-tooltip"
    );
    if (labelTooltips) {
      for (let labelTooltip of labelTooltips) {
        let typeIconHoverTooltip = labelTooltip.lastChild.tagName;
        if (typeIconHoverTooltip === "DIV") {
          let lengthLabelTooltip = labelTooltip.offsetWidth;
          let lengthIconHoverTooltip = labelTooltip.lastChild.offsetLeft;
          let elementTooltip = labelTooltip.lastChild.lastChild;

          if (lengthIconHoverTooltip >= lengthLabelTooltip / 2) {
            elementTooltip.style.transform = "translateX(-85%)";
            elementTooltip.style.left = "45px";
          } else {
            elementTooltip.style.transform = "unset";
            elementTooltip.style.left = "unset";
          }
        }
      }
    }
  }, 100);
}
apoOptionsResponsiveTooltip();

function apoCustomizeChangeBGRadio() {
  var shopDomain = window.Shopify.shop;
  if (shopDomain === "swissactiva.myshopify.com") {
    setInterval(function () {
      let apElements = document.querySelector("#avpoptions-container__v2");
      if (apElements) {
        // Add background color Radio button
        for (let i = 0; i < $(".ap-options__radio input").length; i++) {
          if ($($(".ap-options__radio input")[i]).is(":checked") == true) {
            $(
              $(".ap-options__radio .avp-productoptioncheckwrapper")[i]
            ).addClass("apo-selected");
          }
          if ($($(".ap-options__radio input")[i]).is(":checked") == false) {
            $(
              $(".ap-options__radio .avp-productoptioncheckwrapper")[i]
            ).removeClass("apo-selected");
          }
        }
      }
    }, 500);
  }
}
apoCustomizeChangeBGRadio();

function apoCustomAccordion() {
  setInterval(function () {
    let apElements = document.querySelector("#avpoptions-container__v2");
    if (apElements) {
      let avpoAccordionMultipleItems = document.querySelectorAll(
        ".apo-customize__accordion .ap-label-tooltip"
      );
      let avpoAccordionOptionItems = document.querySelectorAll(
        ".apo-customize__accordion > span"
      );

      for (let i = 0; i < avpoAccordionMultipleItems.length; i++) {
        let checkExist = avpoAccordionOptionItems[i].parentNode.querySelector(
          ".apo-accordion__item"
        );

        avpoAccordionMultipleItems[i].addEventListener("click", function () {
          if (!checkExist) {
            avpoAccordionOptionItems[i].classList.add("apo-accordion__item");
          }
          if (checkExist) {
            avpoAccordionOptionItems[i].removeAttribute("class");
          }
        });
      }
    }
  }, 100);
}

apoCustomAccordion();

function apoWidgetPositionShopiyVariant() {
  var shopDomain = window.Shopify.shop
  let intervalApoWidgetPositionShopiyVariant = setInterval(function () {
    let apElements = document.querySelector('.avis-swatch-product-container');
    if (apElements) {
      switch (shopDomain) {
        case shopDomain === "877b65.myshopify.com":
          document.querySelector('.product-price-container').before(document.querySelector('.avis-swatch-product-container'));
          break;
      }
    }
  }, 100);
  function forceQuitInterval() {
    clearInterval(intervalApoWidgetPositionShopiyVariant);
  }
  setTimeout(forceQuitInterval, 10000);
}
apoWidgetPositionShopiyVariant();

function apoCustomizeSwatchWithPrice() {
  var shopDomain = window.Shopify.shop
  if (
    (shopDomain === "hoang-apo-test-app-v2.myshopify.com" ||
      shopDomain === "3f80fc.myshopify.com") &&
    (window.ap_front_settings.config.config_app.appPlan === "ADVANCED" ||
      window.ap_front_settings.config.config_app.appPlan === "PREMIUM")
  ) {
    setInterval(function () {
      let apElements = document.querySelector('#avpoptions-container__v2');
      if (apElements) {
        let swatchWithPrice = document.querySelectorAll('.swatch-with_price .avp-productoptionswatchwrapper > input');
        for (let item of swatchWithPrice) {
          if (item.checked) {
            item.parentElement.classList.add("apo-checked");
          } else {
            item.parentElement.classList.remove("apo-checked");
          }
        }
      }
    }, 100);
  } else {
    setInterval(function () {
      let apElements = document.querySelector("#avpoptions-container__v2");
      if (apElements) {
        document.querySelectorAll('.avp-option.ap-options__swatch-container').forEach(element => {
          element.classList.remove("swatch-with_price");
        })
      }
    }, 100)
  }
}
apoCustomizeSwatchWithPrice();


const getCartJs = async () => fetch("/cart.js?avis", { method: "GET" }).then((t) => t.json()).then((t) => t);
async function logCart() {
  var cart = await getCartJs();
  if (cart?.items?.length) {
    let productItems = null;
    if (window.ap_front_settings?.shop_id === "76328501580")
      productItems = cart?.items?.filter(x => x.product_id === 8635125334348 && (!x?.properties["Prnoms ou titre"] || !x?.properties["Anne de la srie"] || !x?.properties["Description "]));
    if (window.ap_front_settings?.shop_id === "59625603264")
      productItems = cart?.items?.filter(x => (x.product_id === 7424621215936 && (!x?.properties["BC Embroidery Option"] || !x?.properties["Border Collie Color"] || !x?.properties["Border Collie #1"] || !x?.properties["Border Collie #2"] || !x?.properties["Border Collie #3"])) ||
        (x.product_id === 7504480600256 && !x?.properties["Border Collie Colour"]) ||
        (x.product_id === 7622404178112 && (!x?.properties["Golden Embroidery Option"] || !x?.properties["Golden Retriever Option"] || !x?.properties["1st Golden Retriever"] || !x?.properties["2nd Golden Retriever"]))
      );

    if (productItems.length > 0) {
      let data = {
        shop_domain: Shopify?.shop,
        content: {
          browser: navigator.userAgent,
          cartItems: productItems
        }
      }
      fetch("https://apo-api.avisplus.io/api/sf/tracking-cart", {
        method: "POST", headers: {
          "Content-Type": "application/json",
          "access-token": "avis@123"
        }, body: JSON.stringify(data)
      }).then((t) => t.json()).then((t) => t)
    }
  }
}

if ((window.ap_front_settings?.shop_id === "76328501580" && window.ap_front_settings.page_type === "cart") ||
  window.ap_front_settings?.shop_id === "59625603264"
) {
  try {
    logCart();
  } catch (ex) { }
}
if (window.ap_front_settings?.shop_id === "76328501580" && window.ap_front_settings.page_type === "product") {
  console.log("avis load page");
  setTimeout(function () {
    let optionsSelectors = document.querySelectorAll(".avis-input-hiddens input");
    for (let optionSelector of optionsSelectors) {
      let fieldName = optionSelector.getAttribute("name");
      if (fieldName) {
        fieldName = fieldName.replace('properties[', '');
        fieldName = fieldName.substring(0, fieldName.length - 1);
      }
      let viewSelector = document.querySelector(`[name='${fieldName}']`);
      if (viewSelector.value && !viewSelector.getAttribute("disabled")) {
        optionSelector.value = viewSelector.value;
        optionSelector.removeAttribute("disabled");
      }
    }
  }, 500)
}

